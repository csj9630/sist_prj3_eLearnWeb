<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>관리자 대시보드</title>
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" />
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
<link rel="stylesheet" th:href="@{/admin/dashboard/dashboard.css}" />
<link rel="stylesheet" th:href="@{/admin/announcement/announcement.css}" />
<!-- 다이얼로그 용 라이브러리 -->
<link rel="stylesheet" href="https://code.jquery.com/ui/1.13.3/themes/base/jquery-ui.css">
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://code.jquery.com/ui/1.13.3/jquery-ui.min.js"></script>
<script type="text/javascript" th:inline="javascript">
$(function() {
    $('#content').summernote({
        placeholder: '공지사항 내용을 작성해주세요.',
        tabsize: 2,
        height: 300,
        width: 500,
        toolbar: [
			// [groupName, [list of button]]
			['style', ['bold', 'italic', 'underline', 'clear']],
			['font', ['strikethrough', 'superscript', 'subscript']],
			['fontsize', ['fontsize']],
			['color', ['color']],
			['para', ['ul', 'ol', 'paragraph']],
			['height', ['height']],
			['insert', ['link', 'picture']]
		]
    });
    
	$("#btnModify").click(function() {
		if(confirm("글을 정말 수정하시겠습니까?")) {
			// 내용에 값이 있는지 유효성 검증
			if($("#content").val() == "" || $("#content").val() == "<p></p>") {
				alert("내용은 필수 입력입니다.");
				return;
			} // end if
			$("#frm")[0].action = "/admin/announcement/modifyAnnouncementProcess?currentPage=[[${param.currentPage}]]";
			$("#frm").submit();
		}
		
	});
	
	$("#btnDelete").click(function() {
		if(confirm("글을 정말 삭제하시겠습니까?")) {
			$("#frm")[0].action = "/admin/announcement/removeAnnouncementProcess?currentPage=[[${param.currentPage}]]";
			$("#frm").submit();
		}
	});
}); // ready

function searchAnnouncement() {
	if($("#keyword").val().trim() != null) {
		$("#announcementSearchFrm").submit();
	} // end if
} // searchAnnouncement
</script>
</head>
<body class="admin-dashboard">
  <div id="header">
    <th:block th:replace="~{fragments/adminHeader :: adminHeader}"></th:block>
  </div>
	
  <div class="admin-layout">
    <aside class="admin-sidebar">
      <th:block th:replace="~{fragments/adminSidebar :: adminSidebar}"></th:block>
    </aside>
	
	<!-- 좌측 상단 제목 -->
    <main class="admin-content">
      <section class="announcement-page">
        <header class="announcement-header">
          <h1>공지사항 세부 관리</h1>
        </header>
		
		<!-- 옵션 선택바 -->
        <div class="announcement-toolbar" style = "display: flex;">
          <!--
          <form th:action = "@{/admin/announcement/announcementList}" id = "announcementSearchFrm">
          -->
          <form th:action = "@{{url}(url = '/admin/announcement/announcementList', field = ${param.lectId}, keyword = ${param.keyword},currentPage = ${param.currentPage})}" id = "announcementSearchFrm">
          <div class="announcement-filter">
          	<span>제목</span>
		  </div>
          </form>
		  <div style = "margin-left: auto;">
			<input type = "button" value = "글쓰기" class = "btn btn--primary" id = "btnWrite"/>
		  </div>
        </div>
		
		<!-- 테이블 내용 -->
		<table class = "announcement-table">
		<thead>
		<tr>
			<th style = "width: 80px">번호</th>
			<th style = "width: 450px">제목</th>
			<th style = "width: 150px">작성자 ID</th>
			<th style = "width: 80px">조회수</th>
			<th style = "width: 200px">작성일</th>
		</tr>
		</thead>
		<tbody>
		<th:block th:if = "${announcementList.empty}">
		<tr>
			<td colspan = "5" style = "text-align: center;">게시글이 없습니다.</td>
		</tr>
		</th:block>
		<tr class="announcement-row" th:each = "announcementDomain, i : ${announcementList}" th:object = "${announcementDomain}">
			<td th:text = "${listNum - i.index}">번호</td>
			<td class="announcement-title"><a th:href = "@{{url}(url = '/admin/announcement/announcementDetail', annId = *{ann_id}, currentPage = ${param.currentPage})}"><span th:text = "*{title}">제목</span></a></td>
			<td th:text = "*{adm_id}">작성자 ID</td>
			<td th:text = "*{views}">조회수</td>
			<td th:text = "*{#dates.format(regdate, 'yyyy-MM-dd EEEE')}">작성일</td>
		</tr>
		</tbody>
		</table>
      </section>
      
    </main>
  </div>
</body>
</html>
